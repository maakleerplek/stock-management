{"version":3,"file":"ManufacturerPartTable-CUciRCYo.js","sources":["../../../../../../frontend/src/tables/purchasing/ManufacturerPartTable.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { type ReactNode, useCallback, useMemo, useState } from 'react';\n\nimport { AddItemButton } from '@lib/components/AddItemButton';\nimport {\n  type RowAction,\n  RowDeleteAction,\n  RowEditAction\n} from '@lib/components/RowActions';\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { apiUrl } from '@lib/functions/Api';\nimport type { TableFilter } from '@lib/types/Filters';\nimport type { TableColumn } from '@lib/types/Tables';\nimport { useManufacturerPartFields } from '../../forms/CompanyForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useTable } from '../../hooks/UseTable';\nimport { useUserState } from '../../states/UserState';\nimport {\n  CompanyColumn,\n  DescriptionColumn,\n  LinkColumn,\n  PartColumn\n} from '../ColumnRenderers';\nimport { InvenTreeTable } from '../InvenTreeTable';\n\n/*\n * Construct a table listing manufacturer parts\n */\nexport function ManufacturerPartTable({\n  manufacturerId,\n  partId\n}: Readonly<{\n  manufacturerId?: number;\n  partId?: number;\n}>): ReactNode {\n  const tableId: string = useMemo(() => {\n    let tId = 'manufacturer-part';\n\n    if (manufacturerId) {\n      tId += '-manufacturer';\n    }\n\n    if (partId) {\n      tId += '-part';\n    }\n\n    return tId;\n  }, [manufacturerId, partId]);\n\n  const table = useTable(tableId);\n\n  const user = useUserState();\n\n  // Construct table columns for this table\n  const tableColumns: TableColumn[] = useMemo(() => {\n    return [\n      PartColumn({\n        switchable: !!partId\n      }),\n      {\n        accessor: 'manufacturer',\n        sortable: true,\n        render: (record: any) => (\n          <CompanyColumn company={record?.manufacturer_detail} />\n        )\n      },\n      {\n        accessor: 'MPN',\n        title: t`MPN`,\n        sortable: true\n      },\n      DescriptionColumn({}),\n      LinkColumn({})\n    ];\n  }, [partId]);\n\n  const manufacturerPartFields = useManufacturerPartFields();\n\n  const [selectedPart, setSelectedPart] = useState<number | undefined>(\n    undefined\n  );\n\n  const createManufacturerPart = useCreateApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    title: t`Add Manufacturer Part`,\n    fields: manufacturerPartFields,\n    table: table,\n    initialData: {\n      manufacturer: manufacturerId,\n      part: partId\n    }\n  });\n\n  const editManufacturerPart = useEditApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    pk: selectedPart,\n    title: t`Edit Manufacturer Part`,\n    fields: manufacturerPartFields,\n    table: table\n  });\n\n  const deleteManufacturerPart = useDeleteApiFormModal({\n    url: ApiEndpoints.manufacturer_part_list,\n    pk: selectedPart,\n    title: t`Delete Manufacturer Part`,\n    table: table\n  });\n\n  const tableFilters: TableFilter[] = useMemo(() => {\n    return [\n      {\n        name: 'part_active',\n        label: t`Active Part`,\n        description: t`Show manufacturer parts for active internal parts.`,\n        type: 'boolean'\n      },\n      {\n        name: 'manufacturer_active',\n        label: t`Active Manufacturer`,\n        active: !manufacturerId,\n        description: t`Show manufacturer parts for active manufacturers.`,\n        type: 'boolean'\n      }\n    ];\n  }, [manufacturerId]);\n\n  const tableActions = useMemo(() => {\n    const can_add =\n      user.hasAddRole(UserRoles.purchase_order) &&\n      user.hasAddRole(UserRoles.part);\n\n    return [\n      <AddItemButton\n        key='add-manufacturer-part'\n        tooltip={t`Add Manufacturer Part`}\n        onClick={() => createManufacturerPart.open()}\n        hidden={!can_add}\n      />\n    ];\n  }, [user]);\n\n  const rowActions = useCallback(\n    (record: any): RowAction[] => {\n      return [\n        RowEditAction({\n          hidden: !user.hasChangeRole(UserRoles.purchase_order),\n          onClick: () => {\n            setSelectedPart(record.pk);\n            editManufacturerPart.open();\n          }\n        }),\n        RowDeleteAction({\n          hidden: !user.hasDeleteRole(UserRoles.purchase_order),\n          onClick: () => {\n            setSelectedPart(record.pk);\n            deleteManufacturerPart.open();\n          }\n        })\n      ];\n    },\n    [user]\n  );\n\n  return (\n    <>\n      {createManufacturerPart.modal}\n      {editManufacturerPart.modal}\n      {deleteManufacturerPart.modal}\n      <InvenTreeTable\n        url={apiUrl(ApiEndpoints.manufacturer_part_list)}\n        tableState={table}\n        columns={tableColumns}\n        props={{\n          params: {\n            part: partId,\n            manufacturer: manufacturerId,\n            part_detail: true,\n            manufacturer_detail: true\n          },\n          enableDownload: true,\n          rowActions: rowActions,\n          tableActions: tableActions,\n          tableFilters: tableFilters,\n          modelType: ModelType.manufacturerpart\n        }}\n      />\n    </>\n  );\n}\n"],"names":["ManufacturerPartTable","manufacturerId","partId","tableId","useMemo","tId","table","useTable","user","useUserState","tableColumns","PartColumn","switchable","accessor","sortable","render","record","CompanyColumn","manufacturer_detail","title","_i18n","_","id","DescriptionColumn","LinkColumn","manufacturerPartFields","useManufacturerPartFields","selectedPart","setSelectedPart","useState","undefined","createManufacturerPart","useCreateApiFormModal","url","ApiEndpoints","manufacturer_part_list","fields","initialData","manufacturer","part","editManufacturerPart","useEditApiFormModal","pk","deleteManufacturerPart","useDeleteApiFormModal","tableFilters","name","label","description","type","active","tableActions","can_add","hasAddRole","UserRoles","purchase_order","jsx","AddItemButton","open","rowActions","useCallback","RowEditAction","hidden","hasChangeRole","onClick","RowDeleteAction","hasDeleteRole","jsxs","Fragment","modal","InvenTreeTable","apiUrl","params","part_detail","enableDownload","modelType","ModelType","manufacturerpart"],"mappings":"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"}