import{r as a,b2 as f,ab as s,ao as n,j as e,am as A,c as d,an as u,e as P,c9 as U,U as B,d as M,$ as v,bd as z,cw as S}from"./index-DjOBj_Ai.js";import{c as E,m as w,ac as I}from"./Filter-CpWhllKn.js";import{a9 as L,ag as W,S as G}from"./ThemeContext-BjJu0IKI.js";import{u as O,I as q}from"./InvenTreeTable-C-s5lvnS.js";import{B as p,U as J}from"./ColumnRenderers-BCeqgJNS.js";function Z({only_myself:r=!0}){const[c,x]=a.useState(""),[m,{open:b,close:j}]=f(!1),l=E({url:n.user_tokens,title:s._({id:"PxJ9W6"}),fields:{name:{}},successMessage:s._({id:"jUAqIc"}),onFormSuccess:t=>{x(t.token),b(),o.refreshTable()}}),h=a.useMemo(()=>r?[e.jsx(w,{tooltip:s._({id:"PxJ9W6"}),onClick:()=>l.open()},"generate")]:[],[r]),o=O("api-tokens","id"),k=a.useMemo(()=>{const t=[{accessor:"name",title:s._({id:"6YtxFj"}),sortable:!0},p({accessor:"active",title:s._({id:"F6pfE9"}),sortable:!1}),p({accessor:"revoked",title:s._({id:"xGiT1z"})}),{accessor:"token",title:s._({id:"TP9/K5"}),render:i=>e.jsxs(e.Fragment,{children:[i.token," ",i.in_use?e.jsx(A,{color:"green",children:e.jsx(d,{id:"OxPEUg"})}):null]})},{accessor:"last_seen",title:s._({id:"bLZksC"}),sortable:!0},{accessor:"expiry",title:s._({id:"agO/T/"}),sortable:!0},{accessor:"created",title:s._({id:"d+F6q9"}),sortable:!0}];return r||t.push(J({accessor:"user_detail",ordering:"user",title:s._({id:"7PzzBU"})})),t},[r]),T=a.useMemo(()=>{const t=[{name:"revoked",label:s._({id:"xGiT1z"}),description:s._({id:"iFQOwR"})}];return r||t.push(I({name:"user",label:s._({id:"7PzzBU"}),description:s._({id:"FVjW63"})})),t},[r]),_=a.useCallback(t=>[{title:s._({id:"GXsAby"}),color:"red",hidden:!t.active||t.in_use,icon:e.jsx(L,{}),onClick:()=>{g(t.id)}}],[]),g=async t=>{let i=u(n.user_tokens,t);r||(i+="?all_users=true"),P.delete(i).then(()=>{o.refreshTable()}).catch(F=>{U({error:F,title:s._({id:"LQLPLZ"})})})},C=a.useMemo(()=>r?{}:{all_users:!0},[r]);return e.jsxs(e.Fragment,{children:[r&&e.jsxs(e.Fragment,{children:[l.modal,e.jsxs(B,{opened:m,onClose:j,title:e.jsx(G,{size:"xl",children:s._({id:"TP9/K5"})}),centered:!0,children:[e.jsx(M,{c:"dimmed",children:e.jsx(d,{id:"VWjAuB"})}),e.jsx(v,{p:"sm",children:e.jsxs(z,{children:[e.jsx(S,{children:c}),e.jsx(W,{value:c})]})})]})]}),e.jsx(q,{tableState:o,url:u(n.user_tokens),columns:k,props:{params:C,rowActions:_,enableSearch:!1,enableColumnSwitching:!1,tableActions:h,tableFilters:T}})]})}export{Z as A};
//# sourceMappingURL=ApiTokenTable-BG3Hu2m5.js.map
