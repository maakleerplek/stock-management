import{ag as D,az as R,b2 as y,r as a,j as e,N as B,d as o,am as g,ab as t,aO as k,ao as T,ba as C,S as b,aq as E,a8 as v,an as A,aj as M,ak as s}from"./index-DjOBj_Ai.js";import{u as O,a as U,I as F}from"./InvenTreeTable-C-s5lvnS.js";import{P as S}from"./YesNoButton-CYsvXLSb.js";import{S as x,ag as j}from"./ThemeContext-BjJu0IKI.js";import{t as I,ac as P,e as q,ae as G}from"./Filter-CpWhllKn.js";import"./DesktopAppView-D6tHFi_e.js";import"./IconChevronDown-I6OOyduR.js";import"./index-_kfXKtfq.js";import"./ActionButton-D4nRdKaB.js";import"./QRCode-BL-P7mX-.js";import"./browser-JUP5PmmS.js";import"./IconDotsVertical-CGvw5eIR.js";import"./IconTags-Bukq1non.js";function H({scan:r}){const n={textWrap:"wrap",lineBreak:"auto",wordBreak:"break-word"},d=a.useMemo(()=>r.response&&Object.keys(r.response).length>0,[r.response]),c=a.useMemo(()=>r.context&&Object.keys(r.context).length>0,[r.context]);return e.jsxs(b,{gap:"xs",children:[e.jsx(M,{}),e.jsx(s,{children:e.jsxs(s.Tbody,{children:[e.jsx(s.Tr,{children:e.jsx(s.Td,{colSpan:2,children:e.jsx(x,{size:"sm",children:t._({id:"HsJeTk"})})})}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"ap+FLU"})}),e.jsx(s.Td,{children:e.jsx(o,{size:"sm",style:n,children:r.data})}),e.jsx(s.Td,{children:e.jsx(j,{value:r.data,size:"xs"})})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"8TMaZI"})}),e.jsx(s.Td,{children:r.timestamp})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"7PzzBU"})}),e.jsx(s.Td,{children:e.jsx(G,{instance:r.user_detail})})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"FCKppt"})}),e.jsx(s.Td,{children:r.endpoint})]}),e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:t._({id:"RD6AE9"})}),e.jsx(s.Td,{children:e.jsx(S,{value:r.result})})]}),c&&e.jsx(s.Tr,{children:e.jsx(s.Td,{colSpan:2,children:e.jsx(x,{size:"sm",children:t._({id:"M73whl"})})})}),c&&Object.keys(r.context).map(i=>e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:i}),e.jsx(s.Td,{children:e.jsx(o,{size:"sm",style:n,children:r.context[i]})}),e.jsx(s.Td,{children:e.jsx(j,{value:r.context[i],size:"xs"})})]},i)),d&&e.jsx(s.Tr,{children:e.jsx(s.Td,{colSpan:2,children:e.jsx(x,{size:"sm",children:t._({id:"ZlCDf+"})})})}),d&&Object.keys(r.response).map(i=>e.jsxs(s.Tr,{children:[e.jsx(s.Th,{children:i}),e.jsx(s.Td,{children:e.jsx(o,{size:"sm",style:n,children:r.response[i]})}),e.jsx(s.Td,{children:e.jsx(j,{value:r.response[i],size:"xs"})})]},i))]})})]})}function re(){const r=D(),n=O("barcode-history"),d=R(),[c,{open:i,close:_}]=y(!1),f=a.useMemo(()=>[{accessor:"timestamp",sortable:!0,switchable:!1,render:l=>e.jsxs(B,{justify:"space-between",wrap:"nowrap",children:[e.jsx(o,{children:l.timestamp}),l.user_detail&&e.jsx(g,{size:"xs",children:l.user_detail.username})]})},{accessor:"data",sortable:!1,switchable:!0,render:l=>e.jsx(o,{size:"xs",style:{textWrap:"wrap",lineBreak:"auto",wordBreak:"break-word"},children:I({str:l.data,len:100})})},{accessor:"endpoint",sortable:!0},{accessor:"result",sortable:!0,render:l=>e.jsx(S,{value:l.result})}],[]),w=a.useMemo(()=>[P({}),{name:"result",label:t._({id:"RD6AE9"}),description:t._({id:"+Bt9q7"})}],[]),h=a.useMemo(()=>r.isStaff()&&r.hasDeleteRole(k.admin),[r]),[u,p]=a.useState({}),m=q({url:T.barcode_history,pk:u.pk,title:t._({id:"XBxqOY"}),table:n}),z=a.useCallback(l=>[U({hidden:!h,onClick:()=>{p(l),m.open()}})],[h,r]);return e.jsxs(e.Fragment,{children:[m.modal,e.jsx(C,{opened:c,size:"xl",position:"right",title:e.jsx(x,{children:t._({id:"y1GSyz"})}),onClose:_,children:e.jsx(H,{scan:u})}),e.jsxs(b,{gap:"xs",children:[!d.isSet("BARCODE_STORE_RESULTS")&&e.jsx(E,{color:"red",icon:e.jsx(v,{}),title:t._({id:"d20v+o"}),children:e.jsx(o,{children:t._({id:"y6SrPr"})})}),e.jsx(F,{url:A(T.barcode_history),tableState:n,columns:f,props:{tableFilters:w,enableBulkDelete:h,rowActions:z,onRowClick:l=>{p(l),i()}}})]})]})}export{re as default};
//# sourceMappingURL=BarcodeScanHistoryTable-BzEYRBI5.js.map
