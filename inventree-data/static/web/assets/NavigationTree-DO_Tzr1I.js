import{cz as C,r as h,aD as S,bi as D,b9 as z,j as a,N as x,al as E,ac as I,A as N,ba as q,S as T,aj as L,ap as F,aq as M,ab as m,a8 as R,cA as U,an as _}from"./index-DjOBj_Ai.js";import{a as $,A as B,ar as G,S as K}from"./ThemeContext-BjJu0IKI.js";import{u as O}from"./DesktopAppView-D6tHFi_e.js";import{A as Q}from"./Filter-CpWhllKn.js";import{a as Y}from"./IconChevronDown-I6OOyduR.js";import{I as y}from"./IconChevronRight-BBTCuiZt.js";function Z({title:f,opened:o,onClose:p,selectedId:l,modelType:c,endpoint:v}){const w=O(),d=$(),u=C(),t=B({enabled:o,queryKey:[c,o],queryFn:async()=>w.get(_(v),{data:{ordering:"level"}}).then(e=>e.data??[])}),b=h.useCallback((e,n)=>{const s=S(c,e.value);D(n)?z(s,d,n):(p(),d(s))},[c,d]),k=h.useMemo(()=>{const e={},n=[];if(!t||!t?.data?.length)return[];for(let s=0;s<t.data.length;s++){const r={...t.data[s],children:[],label:a.jsxs(x,{gap:"xs",children:[a.jsx(Q,{name:t.data[s].icon}),t.data[s].name]}),value:t.data[s].pk.toString(),selected:t.data[s].pk===l},j=r.pk,g=r.parent;if(g?e[g]?.children.push(r):n.push(r),e[j]=r,j===l){let i=e[r.parent];for(;i;)i.expanded=!0,i=e[i.parent]}}return n},[l,t.data]),A=h.useCallback(e=>a.jsxs(x,{p:3,gap:"xs",justify:"left",wrap:"nowrap",onClick:()=>{e.hasChildren&&u.toggleExpanded(e.node.value)},children:[a.jsx(E,{w:10*(e.level-1)}),a.jsx(I,{size:"sm",variant:"transparent","aria-label":`nav-tree-toggle-${e.node.value}}`,children:e.hasChildren?e.expanded?a.jsx(Y,{}):a.jsx(y,{}):null}),a.jsx(N,{onClick:n=>b(e.node,n),"aria-label":`nav-tree-item-${e.node.value}`,c:"var(--mantine-color-text)",children:e.node.label})]},e.node.value),[u]);return a.jsx(q,{opened:o,size:"md",position:"left",onClose:p,withCloseButton:!0,styles:{header:{width:"100%"},title:{width:"100%"}},title:a.jsxs(x,{justify:"left",p:"ms",gap:"md",wrap:"nowrap",children:[a.jsx(G,{}),a.jsx(K,{size:"lg",children:f})]}),children:a.jsxs(T,{gap:"xs",children:[a.jsx(L,{}),a.jsx(F,{visible:t.isFetching||t.isLoading}),t.isError?a.jsx(M,{color:"red",title:m._({id:"SlfejT"}),icon:a.jsx(R,{}),children:m._({id:"nY0zwD"})}):a.jsx(U,{data:k,tree:u,renderNode:A})]})})}export{Z as N};
//# sourceMappingURL=NavigationTree-DO_Tzr1I.js.map
