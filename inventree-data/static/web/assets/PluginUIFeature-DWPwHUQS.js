import{K as B,j as a,ab as n,ao as m,r as l,e as O,an as T,az as G,bc as z,aq as b,bX as P,aD as ie,b2 as J,ak as A,S as U,bd as q,d as w,N as ae,b5 as re,u as H,a as le,ag as oe,b3 as ue,ad as de,bf as ce,aC as fe,q as Q,ai as _e,a8 as X}from"./index-DjOBj_Ai.js";import{V as pe,W as he,X as ge,z as D,A as $,a as W,M as me,t as xe,Y as ye,Z as ke,_ as ve,S as be}from"./ThemeContext-BjJu0IKI.js";import{A as I}from"./ActionButton-D4nRdKaB.js";import{a as je,u as Se,b as Ee,d as Ce,c as Z,e as ee,S as Me,T as te,f as Re,g as Fe,h as Ae,i as K,j as we,k as Oe,R as Te}from"./Filter-CpWhllKn.js";function qe(e,s){return pe({...e,enabled:!0,suspense:!0,throwOnError:ge,placeholderData:void 0},he)}/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M15 21h-9a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v5",key:"svg-0"}],["path",{d:"M16 3v4",key:"svg-1"}],["path",{d:"M8 3v4",key:"svg-2"}],["path",{d:"M4 11h16",key:"svg-3"}],["path",{d:"M11 15h1",key:"svg-4"}],["path",{d:"M12 15v3",key:"svg-5"}],["path",{d:"M19 16v3",key:"svg-6"}],["path",{d:"M19 22v.01",key:"svg-7"}]],Ne=B("outline","calendar-exclamation","CalendarExclamation",De);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M9 14c0 1.657 2.686 3 6 3s6 -1.343 6 -3s-2.686 -3 -6 -3s-6 1.343 -6 3z",key:"svg-0"}],["path",{d:"M9 14v4c0 1.656 2.686 3 6 3s6 -1.344 6 -3v-4",key:"svg-1"}],["path",{d:"M3 6c0 1.072 1.144 2.062 3 2.598s4.144 .536 6 0c1.856 -.536 3 -1.526 3 -2.598c0 -1.072 -1.144 -2.062 -3 -2.598s-4.144 -.536 -6 0c-1.856 .536 -3 1.526 -3 2.598z",key:"svg-2"}],["path",{d:"M3 6v10c0 .888 .772 1.45 2 2",key:"svg-3"}],["path",{d:"M3 11c0 .888 .772 1.45 2 2",key:"svg-4"}]],Pe=B("outline","coins","Coins",Ve),Ie="0.7.0",Y="19.1.1",ze="8.2.7";function Ge({onClick:e,tooltip:s=n._({id:"3mIfxA"}),tooltipAlignment:i}){return a.jsx(I,{onClick:e,icon:a.jsx(D,{icon:"square_x"}),tooltip:s,tooltipAlignment:i??"top-end",color:"red"})}function ne(e){const s=je(),[i,t]=l.useState(null),[r,u]=l.useState({}),[o]=Se(r,100),d=l.useCallback(()=>!(e.isEnabled?.()==!1||e.modalId&&!s.isModalOpen(e.modalId)),[s.isModalOpen,s.openModals,e.isEnabled,e.modalId]),p=l.useCallback((f,c)=>{u(c?f:h=>({...h,...f}))},[]);return $({enabled:!0,queryKey:["generator",e.key,e.endpoint,e.modalId,e.initialQuery,s.openModals,o],refetchOnMount:!1,refetchOnWindowFocus:!1,throwOnError:f=>(console.error(`Error generating ${e.key} @ ${e.endpoint}:`,f),!1),queryFn:async()=>{const f={...e.initialQuery??{},...o};return d()?O.post(T(e.endpoint),f).then(c=>{const h=c?.data[e.key];return t(h),e.onGenerate?.(h),c}):(t(null),null)}}),{query:r,update:p,result:i}}function Le({initialQuery:e,onGenerate:s,isEnabled:i,modalId:t}){return ne({endpoint:m.generate_batch_code,key:"batch_code",initialQuery:e,onGenerate:s,isEnabled:i,modalId:t})}function se({initialQuery:e,onGenerate:s,isEnabled:i,modalId:t}){return ne({endpoint:m.generate_serial_number,key:"serial_number",initialQuery:e,onGenerate:s,isEnabled:i,modalId:t})}function gt({partId:e,stockItem:s,create:i=!1,supplierPartId:t,pricing:r,modalId:u}){const o=G(),[d,p]=l.useState({}),[f,c]=l.useState(t??null),[h,y]=l.useState(null),[x,k]=l.useState(null),[v,M]=l.useState(null),[j,R]=l.useState(null),g=Le({modalId:u,initialQuery:{part:e}}),F=se({modalId:u,initialQuery:{part:e}});return l.useEffect(()=>{if(x==null||!r)return;const S=Object.entries(r).sort(([_],[V])=>Number.parseInt(V)-Number.parseInt(_)).find(([_])=>x>=Number.parseInt(_));S&&(M(S[1][0]),R(S[1][1]))},[r,x]),l.useEffect(()=>{t&&!f&&c(t)},[d,f,t]),l.useEffect(()=>{R(o.getSetting("INVENTREE_DEFAULT_CURRENCY"))},[o]),l.useMemo(()=>{const S={part:{value:d.pk,disabled:!i||!!e,filters:{virtual:!1,active:i?!0:void 0},onValueChange:(_,V)=>{p(V),F.update({part:_}),g.update({part:_}),c(null);const L=V?.default_expiry??0;L&&L>0&&y(Ce().add(L,"days").format("YYYY-MM-DD"))}},supplier_part:{hidden:d?.purchaseable==!1,disabled:!!t,value:f,onValueChange:_=>{c(_)},filters:{part_detail:!0,supplier_detail:!0,part:e},adjustFilters:_=>(_.data.part&&(_.filters.part=_.data.part),_.filters)},use_pack_size:{hidden:!i,description:n._({id:"qyS7x9"})},location:{hidden:!i,onValueChange:_=>{g.update({location:_})},filters:{structural:!1}},quantity:{hidden:!i,description:n._({id:"LWFE8j"}),onValueChange:_=>{g.update({quantity:_}),k(_)}},serial_numbers:{field_type:"string",label:n._({id:"VzQT2x"}),disabled:d?.trackable==!1,description:n._({id:"0dR85g"}),required:!1,hidden:!i,placeholderAutofill:!0,placeholder:F.result&&`${F.result}+`},serial:{placeholderAutofill:!0,placeholder:F.result,hidden:i||d.trackable==!1||s?.quantity!=null&&s?.quantity!=1},batch:{default:"",placeholderAutofill:!0,placeholder:g.result},status_custom_key:{label:n._({id:"Y3/0dR"})},expiry_date:{icon:a.jsx(Ne,{}),hidden:!o.isSet("STOCK_ENABLE_EXPIRY"),value:h,onValueChange:_=>{y(_)}},purchase_price:{icon:a.jsx(ke,{}),value:v,onValueChange:_=>{M(_)}},purchase_price_currency:{icon:a.jsx(Pe,{}),default:o.getSetting("INVENTREE_DEFAULT_CURRENCY"),value:j,onValueChange:_=>{R(_)}},packaging:{icon:a.jsx(ye,{})},link:{icon:a.jsx(xe,{})},owner:{icon:a.jsx(me,{})},delete_on_deplete:{}};return o.isSet("STOCK_ENABLE_EXPIRY")||delete S.expiry_date,i||delete S.serial_numbers,S},[s,h,d,e,o,f,i,t,v,j,F.result,g.result,i])}function mt(){return l.useMemo(()=>({location:{filters:{structural:!1}},note:{}}),[])}function xt({stockItem:e}){const s=G(),[i,t]=l.useState(null);return l.useEffect(()=>{t(null)},[e]),l.useMemo(()=>({part:{field_type:"related field",required:!0,exclude:!0,label:n._({id:"vgP+9p"}),description:n._({id:"B+pzHp"}),model:z.part,api_url:T(m.part_list),onValueChange:r=>{t(r)},filters:{trackable:!0,in_bom_for:s.isSet("STOCK_ENFORCE_BOM_INSTALLATION")?e.part:void 0}},stock_item:{disabled:!i,filters:{part_detail:!0,in_stock:!0,available:!0,tracked:!0,part:i||void 0}},quantity:{},note:{}}),[s,i,e])}function yt({partId:e,trackable:s,modalId:i}){const t=se({modalId:i,isEnabled:()=>s,initialQuery:{part:e}});return l.useMemo(()=>({quantity:{},serial_numbers:{placeholder:t.result&&`${t.result}+`,placeholderAutofill:!0},destination:{}}),[t.result])}function Ue({stockItem:e,value:s}){const{data:i}=qe({queryKey:["location",e.part_detail?.default_location??e.part_detail?.category_default_location],queryFn:async()=>{const t=T(m.stock_location_list,e.part_detail?.default_location??e.part_detail?.category_default_location);return O.get(t).then(r=>{switch(r.status){case 200:return r.data;default:return null}}).catch(()=>null)}});return a.jsxs(q,{gap:"sm",justify:"space-evenly",align:"center",children:[a.jsxs(q,{gap:"sm",direction:"column",align:"center",children:[a.jsxs(w,{children:[s," x ",e.part_detail.name]}),a.jsx(te,{src:e.part_detail.thumbnail,size:80,align:"center"})]}),a.jsxs(q,{direction:"column",gap:"sm",align:"center",children:[a.jsx(w,{children:e.location_detail?.pathstring??"-"}),a.jsx(D,{icon:"arrow_down"}),a.jsx(l.Suspense,{fallback:a.jsx(re,{width:"150px"}),children:a.jsx(w,{children:i?.pathstring})})]})]})}function Je(e,s,i){ve.openConfirmModal({title:a.jsx(be,{children:n._({id:"AEaskR"})}),children:a.jsx(Ue,{stockItem:e,value:s}),onConfirm:()=>{e.location===e.part_detail?.default_location||e.location===e.part_detail?.category_default_location||O.post(T(m.stock_transfer),{items:[{pk:e.pk,quantity:s,batch:e.batch,status:e.status}],location:e.part_detail?.default_location??e.part_detail?.category_default_location}).then(t=>(i(),t.data)).catch(()=>null)}})}function E({props:e,transfer:s=!1,changeStatus:i=!1,add:t=!1,setMax:r=!1,merge:u=!1,record:o}){const d=l.useMemo(()=>Me(z.stockitem)()?.map(g=>({value:g.value,display_name:g.label}))??[],[]),[p,f]=l.useState(t?0:e.item?.quantity??0),[c,h]=l.useState(void 0),y=()=>{e.removeFn(e.idx)},x=(g,F,S)=>{setTimeout(()=>e.changeFn(g,F,S),0)},[k,v]=J(!1,{onOpen:()=>{s&&x(e.idx,"packaging",o?.packaging||void 0)},onClose:()=>{s&&x(e.idx,"packaging",void 0)}}),[M,j]=J(!1,{onOpen:()=>{h(o?.status_custom_key||o?.status||void 0),e.changeFn(e.idx,"status",o?.status||void 0)},onClose:()=>{h(void 0),x(e.idx,"status",void 0)}}),R=l.useMemo(()=>o?o.serial?`#${o.serial}`:`${o.quantity}`:"-",[o]);return o?a.jsxs(a.Fragment,{children:[a.jsxs(A.Tr,{children:[a.jsx(A.Td,{children:a.jsxs(U,{gap:"xs",children:[a.jsxs(q,{gap:"sm",align:"center",children:[a.jsx(te,{size:40,src:o.part_detail?.thumbnail,align:"center"}),a.jsx("div",{children:o.part_detail?.name})]}),e.rowErrors?.pk?.message&&a.jsx(w,{c:"red",size:"xs",children:e.rowErrors.pk.message})]})}),a.jsx(A.Td,{children:a.jsx(Re,{instance:o.location_detail})}),a.jsx(A.Td,{children:o.batch?o.batch:"-"}),a.jsx(A.Td,{children:a.jsxs(ae,{grow:!0,justify:"space-between",wrap:"nowrap",children:[a.jsx(w,{children:R}),a.jsx(Fe,{status:o.status_custom_key,type:z.stockitem})]})}),!u&&a.jsx(A.Td,{children:a.jsx(Ae,{fieldName:"quantity",fieldDefinition:{field_type:"number",value:p,onValueChange:g=>{f(g),e.changeFn(e.idx,"quantity",g)}},error:e.rowErrors?.quantity?.message})}),a.jsx(A.Td,{children:a.jsxs(q,{gap:"3px",children:[s&&a.jsx(I,{onClick:()=>Je(o,e.item.quantity,y),icon:a.jsx(D,{icon:"default_location"}),tooltip:n._({id:"b+SPUR"}),tooltipAlignment:"top",disabled:!o.part_detail?.default_location&&!o.part_detail?.category_default_location}),i&&a.jsx(I,{size:"sm",icon:a.jsx(D,{icon:"status"}),tooltip:n._({id:"Gt4cm5"}),onClick:()=>j.toggle(),variant:M?"filled":"transparent"}),s&&a.jsx(I,{size:"sm",icon:a.jsx(D,{icon:"packaging"}),tooltip:n._({id:"O7MZ1G"}),onClick:()=>v.toggle(),variant:k?"filled":"transparent"}),a.jsx(Ge,{onClick:()=>e.removeFn(e.idx)})]})})]}),i&&a.jsx(K,{visible:M,onValueChange:g=>{h(g),e.changeFn(e.idx,"status",g||void 0)},fieldName:"status",fieldDefinition:{field_type:"choice",label:n._({id:"uAQUqI"}),choices:d,value:c},defaultValue:c}),s&&a.jsx(K,{visible:s&&k,onValueChange:g=>{e.changeFn(e.idx,"packaging",g||void 0)},fieldName:"packaging",fieldDefinition:{field_type:"string",label:n._({id:"pD/Ew0"})},defaultValue:o.packaging})]}):a.jsx("div",{children:n._({id:"Z3FXyt"})})}function N(e){return e.map(i=>({pk:i.pk,quantity:i.quantity,batch:i.batch||void 0,status:i.status||void 0,packaging:i.packaging||void 0,obj:i}))}function Qe(e){if(!e)return{};const s=Object.fromEntries(e.map(r=>[r.pk,r])),i=[...new Set(e.map(r=>r.location))];return{items:{field_type:"table",value:N(e),modelRenderer:r=>{const u=s[r.item.pk];return a.jsx(E,{props:r,transfer:!0,changeStatus:!0,setMax:!0,record:u},u.pk)},headers:[{title:n._({id:"vgP+9p"})},{title:n._({id:"wJijgU"})},{title:n._({id:"rsx3xA"})},{title:n._({id:"blbbPS"})},{title:n._({id:"QWdKwH"}),style:{width:"200px"}},{title:n._({id:"7L01XJ"})}]},location:{value:i.length===1?i[0]:void 0,filters:{structural:!1}},notes:{}}}function Ke(e){if(!e)return{};const s=Object.fromEntries(e.filter(t=>!t.in_stock).map(t=>[t.pk,t]));return{items:{field_type:"table",value:N(e),modelRenderer:t=>{const r=s[t.item.pk];return a.jsx(E,{props:t,record:r,transfer:!0,changeStatus:!0},r.pk)},headers:[{title:n._({id:"vgP+9p"})},{title:n._({id:"wJijgU"})},{title:n._({id:"rsx3xA"})},{title:n._({id:"VbWX2u"})},{title:n._({id:"vUOn9d"}),style:{width:"200px"}},{title:n._({id:"7L01XJ"})}]},location:{filters:{structural:!1}},merge:{},notes:{}}}function Ye(e){if(!e)return{};const s=Object.fromEntries(e.map(t=>[t.pk,t]));return{items:{field_type:"table",value:N(e),modelRenderer:t=>{const r=s[t.item.pk];return a.jsx(E,{props:t,setMax:!0,changeStatus:!0,add:!0,record:r},r.pk)},headers:[{title:n._({id:"vgP+9p"})},{title:n._({id:"wJijgU"})},{title:n._({id:"rsx3xA"})},{title:n._({id:"zn38D/"})},{title:n._({id:"t/YqKh"}),style:{width:"200px"}},{title:n._({id:"7L01XJ"})}]},notes:{}}}function Be(e){if(!e)return{};const s=Object.fromEntries(e.map(t=>[t.pk,t]));return{items:{field_type:"table",value:N(e),modelRenderer:t=>{const r=s[t.item.pk];return a.jsx(E,{changeStatus:!0,props:t,add:!0,record:r},r.pk)},headers:[{title:n._({id:"vgP+9p"})},{title:n._({id:"wJijgU"})},{title:n._({id:"rsx3xA"})},{title:n._({id:"zn38D/"})},{title:n._({id:"m16xKo"}),style:{width:"200px"}},{title:n._({id:"7L01XJ"})}]},notes:{}}}function He(e){if(!e)return{};const s=Object.fromEntries(e.map(t=>[t.pk,t]));return{items:{field_type:"table",value:N(e),modelRenderer:t=>a.jsx(E,{props:t,changeStatus:!0,record:s[t.item.pk]},t.item.pk),headers:[{title:n._({id:"vgP+9p"})},{title:n._({id:"wJijgU"})},{title:n._({id:"rsx3xA"})},{title:n._({id:"zn38D/"})},{title:n._({id:"wBMjJ2"}),style:{width:"200px"}},{title:n._({id:"7L01XJ"})}]},notes:{}}}function Xe(e){if(!e)return{};const s=Object.fromEntries(e.map(r=>[r.pk,r])),i=[...new Set(e.map(r=>r.status_custom_key??r.status))];return{items:{field_type:"table",value:e.map(r=>r.pk),modelRenderer:r=>a.jsx(E,{props:r,merge:!0,record:s[r.item]},r.item),headers:[{title:n._({id:"vgP+9p"})},{title:n._({id:"wJijgU"})},{title:n._({id:"rsx3xA"})},{title:n._({id:"zn38D/"})},{title:"",style:{width:"50px"}}]},status:{value:i.length===1?i[0]:void 0},note:{}}}function $e(e){if(!e)return{};const s=Object.fromEntries(e.map(t=>[t.pk,t]));return{items:{field_type:"table",value:e.map(t=>({item:t.pk,obj:t})),modelRenderer:t=>a.jsx(E,{props:t,merge:!0,changeStatus:!0,record:s[t.item.item]},t.item.item),headers:[{title:n._({id:"vgP+9p"})},{title:n._({id:"wJijgU"})},{title:n._({id:"rsx3xA"})},{title:n._({id:"zn38D/"})},{title:n._({id:"7L01XJ"})}]},location:{default:e[0]?.part_detail?.default_location,filters:{structural:!1}},notes:{},allow_mismatched_suppliers:{},allow_mismatched_status:{}}}function We(e){if(!e)return{};const s=Object.fromEntries(e.map(t=>[t.pk,t]));return{items:{field_type:"table",value:e.map(t=>({item:t.pk,obj:t})),modelRenderer:t=>a.jsx(E,{props:t,merge:!0,record:s[t.item.item]},t.item.item),headers:[{title:n._({id:"vgP+9p"})},{title:n._({id:"wJijgU"})},{title:n._({id:"rsx3xA"})},{title:n._({id:"zn38D/"})},{title:"",style:{width:"50px"}}]},customer:{filters:{is_customer:!0}},notes:{}}}function Ze(e){if(!e)return{};const s=Object.fromEntries(e.map(t=>[t.pk,t]));return{items:{field_type:"table",value:e.map(t=>t.pk),modelRenderer:t=>{const r=s[t.item];return a.jsx(E,{props:t,merge:!0,record:r},r.pk)},headers:[{title:n._({id:"vgP+9p"})},{title:n._({id:"wJijgU"})},{title:n._({id:"rsx3xA"})},{title:n._({id:"zn38D/"})},{title:"",style:{width:"50px"}}]}}}function C({items:e,pk:s,model:i,refresh:t,fieldGenerator:r,endpoint:u,filters:o,title:d,preFormContent:p,successMessage:f,modalFunc:c=Z}){const h={part_detail:!0,location_detail:!0,cascade:!1},y=l.useMemo(()=>{const j={...h,...o??{}};return j[i]=s===void 0&&i==="location"?"null":s,j},[h,o,i,s]),[x,k]=l.useState(!1),{data:v}=$({queryKey:["stockitems",x,i,s,e,y],queryFn:async()=>{if(e)return Array.isArray(e)?e:[e];if(!s||!x)return[];const j=T(m.stock_item_list);return O.get(j,{params:y}).then(R=>R.data??[])}}),M=l.useMemo(()=>r(v),[v]);return c({url:u,fields:M,preFormContent:p,title:d,size:"80%",successMessage:f,onFormSuccess:()=>t(),onClose:()=>k(!1),onOpen:()=>k(!0)})}function et(e){return C({...e,fieldGenerator:Be,endpoint:m.stock_add,title:n._({id:"smUxso"}),successMessage:n._({id:"2kGS2K"}),preFormContent:a.jsx(b,{color:"blue",children:n._({id:"xJKqL/"})})})}function tt(e){return C({...e,fieldGenerator:Ye,endpoint:m.stock_remove,title:n._({id:"dxvf6V"}),successMessage:n._({id:"uMaw0F"}),preFormContent:a.jsx(b,{color:"blue",children:n._({id:"gfgUSo"})})})}function nt(e){return C({...e,fieldGenerator:Qe,endpoint:m.stock_transfer,title:n._({id:"9efe+k"}),successMessage:n._({id:"02r6MH"}),preFormContent:a.jsx(b,{color:"blue",children:n._({id:"fbH5mV"})})})}function st(e){return C({...e,fieldGenerator:Ke,endpoint:m.stock_return,title:n._({id:"YG4Cph"}),successMessage:n._({id:"dgrKO8"}),preFormContent:a.jsx(b,{color:"blue",children:n._({id:"mDdOYy"})})})}function it(e){return C({...e,fieldGenerator:He,endpoint:m.stock_count,title:n._({id:"n/p2QJ"}),successMessage:n._({id:"iEFfQA"}),preFormContent:a.jsx(b,{color:"blue",children:n._({id:"72WIn2"})})})}function at(e){return C({...e,fieldGenerator:Xe,endpoint:m.stock_change_status,title:n._({id:"Y+vtBl"}),successMessage:n._({id:"dbA8fL"}),preFormContent:a.jsx(b,{color:"blue",children:n._({id:"o3Pgji"})})})}function rt(e){return C({...e,fieldGenerator:$e,endpoint:m.stock_merge,title:n._({id:"z5kN6j"}),successMessage:n._({id:"BSKV/s"}),preFormContent:a.jsx(b,{title:n._({id:"jk/4VP"}),color:"yellow",children:a.jsxs(P,{children:[a.jsx(P.Item,{children:n._({id:"XVhOQi"})}),a.jsx(P.Item,{children:n._({id:"Q4eR7g"})}),a.jsx(P.Item,{children:n._({id:"8lj8eJ"})})]})})})}function lt(e){const s=l.useMemo(()=>e.items?.filter(i=>i?.part_detail?.salable),[e.items]);return C({...e,items:s,fieldGenerator:We,endpoint:m.stock_assign,title:n._({id:"i2FExn"}),successMessage:n._({id:"zTh3Rb"})})}function ot(e){return C({...e,fieldGenerator:Ze,endpoint:m.stock_item_list,modalFunc:ee,title:n._({id:"khKVoc"}),successMessage:n._({id:"9Y/rsA"}),preFormContent:a.jsx(b,{color:"red",children:n._({id:"m8YHzp"})})})}function kt(){return{parent:{description:n._({id:"9P2CtI"}),required:!1},name:{},description:{},structural:{},external:{},custom_icon:{field_type:"icon"},location_type:{}}}function vt({partId:e,itemId:s,templateId:i,editing:t=!1,editTemplate:r=!1}){const[u,o]=l.useState([]),[d,p]=l.useState("string"),f=G(),c=l.useMemo(()=>f.isSet("TEST_STATION_DATA"),[f]);return l.useMemo(()=>{const h={stock_item:{value:s,hidden:!0},template:{disabled:!r&&!!i,filters:{include_inherited:!0,part:e},onValueChange:(y,x)=>{if(x?.choices){const k=x.choices.split(",");k.length>0?(o(k.map(v=>({label:v.trim(),value:v.trim()}))),p("choice")):(o([]),p("string"))}}},result:{},value:{field_type:d,choices:d==="choice"?u:void 0},attachment:{},notes:{},started_datetime:{hidden:!c},finished_datetime:{hidden:!c},test_station:{hidden:!c}};return t&&delete h.attachment,h},[u,t,r,d,e,s,i,c])}function bt({partId:e}){const s=W();return Ee({url:T(m.stock_item_list),fetchInitialData:!1,method:"GET",title:n._({id:"2eYP7g"}),fields:{serial:{},part_tree:{value:e,hidden:!0,field_type:"integer"}},checkClose:(i,t)=>!i||i?.length==0?(t.setError("serial",{message:n._({id:"v9VtFc"})}),!1):i.length>1?(t.setError("serial",{message:n._({id:"LEfZTz"})}),!1):i[0].pk?!0:(t.setError("serial",{message:n._({id:"kKl9OE"})}),!1),onFormSuccess:i=>{i.length==1&&i[0].pk&&s(ie(z.stockitem,i[0].pk))}})}const jt=()=>{const[e,s]=H(le(f=>[f.language,f.host])),i=W(),t=oe(),{colorScheme:r}=ue(),u=de(),o=G(),d=ce();return l.useMemo(()=>({version:{inventree:Ie,react:Y,reactDom:Y,mantine:ze},user:t,host:s,i18n:n,locale:e,api:O,queryClient:Q,navigate:i,globalSettings:o,userSettings:d,modelInformation:fe,renderInstance:Te,theme:u,colorScheme:r,forms:{bulkEdit:Oe,create:Z,delete:ee,edit:we,stockActions:{addStock:et,assignStock:lt,changeStatus:at,countStock:it,deleteStock:ot,mergeStock:rt,removeStock:tt,transferStock:nt,returnStock:st}}}),[t,s,O,e,Q,i,o,d,u,r])};async function ut(e){if(e=e.trim(),!e)return null;const s=_e(e);return await import(s).catch(t=>(console.error(`ERR: Failed to load plugin from ${s}:`,t),null)).then(t=>t)}async function dt(e,s){const{getHost:i}=H.getState(),t=new URL(e,i());if(t.pathname.includes(":")){const u=t.pathname.split(":");e=u[0],s=u[1]||s,t.pathname=e}const r=await ut(t.toString());return r?.[s]?r[s]:null}async function St(e,s,i){dt(e,s).then(t=>{if(t)return t(i)})}var ct=(e=>(e.spotlight_action="spotlight_action",e.dashboard="dashboard",e.panel="panel",e.template_editor="template_editor",e.template_preview="template_preview",e.navigation="navigation",e))(ct||{});const Et=(e,s)=>l.forwardRef((i,t)=>{const r=l.useRef(null),[u,o]=l.useState(void 0),d=l.useRef(null),p=l.useRef(null),f=l.useRef(null);return l.useImperativeHandle(t,()=>({setCode:c=>{p.current?p.current(c):d.current=c},getCode:()=>f.current?.()})),l.useEffect(()=>{let c;return(async()=>{try{c=await e({ref:r.current,registerHandlers:({getCode:h,setCode:y})=>{p.current=y,f.current=h,d.current&&y(d.current)},template:s})}catch(h){o(n._({id:"t3xUfw"})),console.error(h)}})(),()=>{typeof c=="function"&&c()}},[]),a.jsxs(U,{gap:"xs",style:{display:"flex",flex:1},children:[u&&a.jsx(b,{color:"red",title:n._({id:"JDFeOe"}),icon:a.jsx(X,{}),children:a.jsx(w,{children:u})}),a.jsx("div",{ref:r,style:{display:"flex",flex:1}})]})}),Ct=(e,s)=>l.forwardRef((i,t)=>{const r=l.useRef(null),[u,o]=l.useState(void 0),d=l.useRef(null);return l.useImperativeHandle(t,()=>({updatePreview:(...p)=>d.current?.(...p)})),l.useEffect(()=>{(async()=>{try{e({ref:r.current,registerHandlers:({updatePreview:p})=>{d.current=p},template:s})}catch(p){o(n._({id:"KJx0of"})),console.error(p)}})()},[]),a.jsxs(U,{gap:"xs",style:{display:"flex",flex:1},children:[u&&a.jsx(b,{color:"red",title:n._({id:"OqfJdc"}),icon:a.jsx(X,{}),children:a.jsx(w,{children:u})}),a.jsx("div",{ref:r,style:{display:"flex",flex:1}})]})});export{Pe as I,ct as P,Ge as R,gt as a,Le as b,St as c,se as d,Ne as e,dt as f,et as g,lt as h,at as i,it as j,ot as k,rt as l,tt as m,nt as n,st as o,bt as p,vt as q,xt as r,kt as s,mt as t,jt as u,yt as v,Et as w,Ct as x};
//# sourceMappingURL=PluginUIFeature-DWPwHUQS.js.map
