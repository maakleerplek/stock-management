const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ScheduledTasksTable-c4Eo-2OT.js","./index-DjOBj_Ai.js","./index-GVXg8ZNi.css","./InvenTreeTable-C-s5lvnS.js","./DesktopAppView-D6tHFi_e.js","./ThemeContext-BjJu0IKI.js","./IconChevronDown-I6OOyduR.js","./index-_kfXKtfq.js","./Filter-CpWhllKn.js","./ActionButton-D4nRdKaB.js","./Filter-DfJkRRGL.css","./QRCode-BL-P7mX-.js","./browser-JUP5PmmS.js","./IconDotsVertical-CGvw5eIR.js","./IconTags-Bukq1non.js"])))=>i.map(i=>d[i]);
import{K as T,ag as m,r,b2 as S,ab as s,j as e,ba as I,d as f,an as h,aE as C,av as _,ao as c,a8 as D,aO as E,e as F,bV as w,aq as y,S as z,aj as M,as as t,L as O,_ as R}from"./index-DjOBj_Ai.js";import{S as d,G as P}from"./ThemeContext-BjJu0IKI.js";import{e as A}from"./Alerts-Bb_RrL4j.js";import{F as B}from"./FactCollection-yYrtsdsZ.js";import{u as V}from"./UseInstance-BYH4ds5B.js";import{u as x,I as j}from"./InvenTreeTable-C-s5lvnS.js";import{A as N}from"./ActionButton-D4nRdKaB.js";import"./links-gIae6K_e.js";import"./DesktopAppView-D6tHFi_e.js";import"./IconChevronDown-I6OOyduR.js";import"./index-_kfXKtfq.js";import"./Filter-CpWhllKn.js";import"./QRCode-BL-P7mX-.js";import"./browser-JUP5PmmS.js";import"./IconDotsVertical-CGvw5eIR.js";import"./IconTags-Bukq1non.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M20 6a1 1 0 0 1 .117 1.993l-.117 .007h-.081l-.919 11a3 3 0 0 1 -2.824 2.995l-.176 .005h-8c-1.598 0 -2.904 -1.249 -2.992 -2.75l-.005 -.167l-.923 -11.083h-.08a1 1 0 0 1 -.117 -1.993l.117 -.007h16zm-9.489 5.14a1 1 0 0 0 -1.218 1.567l1.292 1.293l-1.292 1.293l-.083 .094a1 1 0 0 0 1.497 1.32l1.293 -1.292l1.293 1.292l.094 .083a1 1 0 0 0 1.32 -1.497l-1.292 -1.293l1.292 -1.293l.083 -.094a1 1 0 0 0 -1.497 -1.32l-1.293 1.292l-1.293 -1.292l-.094 -.083z",key:"svg-0"}],["path",{d:"M14 2a2 2 0 0 1 2 2a1 1 0 0 1 -1.993 .117l-.007 -.117h-4l-.007 .117a1 1 0 0 1 -1.993 -.117a2 2 0 0 1 1.85 -1.995l.15 -.005h4z",key:"svg-1"}]],X=T("filled","trash-x-filled","TrashXFilled",U);function J({onRecordsUpdated:a}){const l=x("tasks-failed"),i=m(),[u,p]=r.useState(""),[o,{open:k,close:b}]=S(!1),g=r.useMemo(()=>[{accessor:"func",title:s._({id:"Q3P/4s"}),sortable:!0,switchable:!1},{accessor:"pk",title:s._({id:"YgxM31"})},{accessor:"started",title:s._({id:"JEGlfK"}),sortable:!0,switchable:!1},{accessor:"stopped",title:s._({id:"NnvXp5"}),sortable:!0,switchable:!1},{accessor:"attempt_count",title:s._({id:"BCmibk"})}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(I,{opened:o,size:"xl",position:"right",title:e.jsx(d,{children:s._({id:"7Jw/XW"})}),onClose:b,children:u.split(`
`).map((n,v)=>e.jsx(f,{size:"sm",children:n},`error-${v}`))}),e.jsx(j,{url:h(c.task_failed_list),tableState:l,columns:g,props:{enableBulkDelete:i.isStaff(),afterBulkDelete:a,enableSelection:!0,onRowClick:n=>{n.result?(p(n.result),k()):(C("failed-task"),_({id:"failed-task",title:s._({id:"6RoHXm"}),message:s._({id:"OFdRJT"}),color:"red",icon:e.jsx(D,{})}))}}})]})}function G({onRecordsUpdated:a}){const l=x("tasks-pending"),i=m(),u=r.useMemo(()=>[{accessor:"func",title:s._({id:"Q3P/4s"}),switchable:!1},{accessor:"task_id",title:s._({id:"YgxM31"})},{accessor:"name",title:s._({id:"6YtxFj"})},{accessor:"lock",title:s._({id:"d+F6q9"}),sortable:!1,switchable:!1},{accessor:"args",title:s._({id:"OgB1k4"})},{accessor:"kwargs",title:s._({id:"/n/HCO"})}],[]),p=r.useMemo(()=>[e.jsx(N,{icon:e.jsx(X,{}),tooltip:s._({id:"Y1g0pp"}),onClick:()=>{F.delete(`${h(c.task_pending_list)}?all=true`).then(()=>{w.show({id:"notes",title:s._({id:"zzDlyQ"}),message:s._({id:"1B6y2p"}),color:"green"}),l.refreshTable()}).catch(o=>{_({title:s._({id:"mjh4RV"}),message:o.response.data?.non_field_errors??o.message??s._({id:"29VNqC"}),color:"red",icon:e.jsx(P,{})})})},hidden:!i.hasAddRole(E.admin)},"remove-all")],[i]);return e.jsx(j,{url:h(c.task_pending_list),tableState:l,columns:u,props:{afterBulkDelete:a,enableBulkDelete:i.isStaff(),enableSelection:!0,enableSearch:!1,tableActions:p}})}const L=O(r.lazy(()=>R(()=>import("./ScheduledTasksTable-c4Eo-2OT.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]),import.meta.url)));function ne(){const{instance:a,refreshInstance:l}=V({endpoint:c.task_overview,hasPrimaryKey:!1,refetchOnMount:!0,defaultValue:{},updateInterval:3e4});return e.jsxs(e.Fragment,{children:[a?.is_running==!1&&e.jsxs(y,{title:s._({id:"Oe/dvo"}),color:"red",children:[e.jsx(f,{children:s._({id:"HkhyUV"})}),A("INVE-W5")]}),e.jsxs(z,{gap:"xs",children:[e.jsx(B,{items:[{title:s._({id:"sOEpG4"}),value:a?.pending_tasks},{title:s._({id:"8OiyFS"}),value:a?.scheduled_tasks},{title:s._({id:"DJ8M4D"}),value:a?.failed_tasks}]}),e.jsx(M,{}),e.jsxs(t,{defaultValue:"pending",children:[e.jsxs(t.Item,{value:"pending",children:[e.jsx(t.Control,{children:e.jsx(d,{size:"lg",children:s._({id:"sOEpG4"})})}),e.jsx(t.Panel,{children:e.jsx(G,{onRecordsUpdated:l})})]},"pending-tasks"),e.jsxs(t.Item,{value:"scheduled",children:[e.jsx(t.Control,{children:e.jsx(d,{size:"lg",children:s._({id:"8OiyFS"})})}),e.jsx(t.Panel,{children:e.jsx(L,{})})]},"scheduled-tasks"),e.jsxs(t.Item,{value:"failed",children:[e.jsx(t.Control,{children:e.jsx(d,{size:"lg",children:s._({id:"DJ8M4D"})})}),e.jsx(t.Panel,{children:e.jsx(J,{onRecordsUpdated:l})})]},"failed-tasks")]})]})]})}export{ne as default};
//# sourceMappingURL=TaskManagementPanel-3vqFd-8Z.js.map
