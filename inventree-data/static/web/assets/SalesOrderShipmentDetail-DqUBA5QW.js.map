{"version":3,"file":"SalesOrderShipmentDetail-DqUBA5QW.js","sources":["../../../../../../frontend/src/pages/sales/SalesOrderShipmentDetail.tsx"],"sourcesContent":["import { t } from '@lingui/core/macro';\nimport { Alert, Grid, Skeleton, Stack, Text } from '@mantine/core';\nimport {\n  IconBookmark,\n  IconCircleCheck,\n  IconCircleX,\n  IconInfoCircle\n} from '@tabler/icons-react';\nimport { useMemo } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\n\nimport { ApiEndpoints } from '@lib/enums/ApiEndpoints';\nimport { ModelType } from '@lib/enums/ModelType';\nimport { UserRoles } from '@lib/enums/Roles';\nimport { getDetailUrl } from '@lib/functions/Navigation';\nimport dayjs from 'dayjs';\nimport PrimaryActionButton from '../../components/buttons/PrimaryActionButton';\nimport { PrintingActions } from '../../components/buttons/PrintingActions';\nimport {\n  type DetailsField,\n  DetailsTable\n} from '../../components/details/Details';\nimport DetailsBadge from '../../components/details/DetailsBadge';\nimport { DetailsImage } from '../../components/details/DetailsImage';\nimport { ItemDetailsGrid } from '../../components/details/ItemDetails';\nimport {\n  BarcodeActionDropdown,\n  CancelItemAction,\n  EditItemAction,\n  OptionsActionDropdown\n} from '../../components/items/ActionDropdown';\nimport InstanceDetail from '../../components/nav/InstanceDetail';\nimport { PageDetail } from '../../components/nav/PageDetail';\nimport AttachmentPanel from '../../components/panels/AttachmentPanel';\nimport NotesPanel from '../../components/panels/NotesPanel';\nimport type { PanelType } from '../../components/panels/Panel';\nimport { PanelGroup } from '../../components/panels/PanelGroup';\nimport { RenderAddress } from '../../components/render/Company';\nimport { RenderUser } from '../../components/render/User';\nimport { formatDate } from '../../defaults/formatters';\nimport {\n  useSalesOrderShipmentCompleteFields,\n  useSalesOrderShipmentFields\n} from '../../forms/SalesOrderForms';\nimport {\n  useCreateApiFormModal,\n  useDeleteApiFormModal,\n  useEditApiFormModal\n} from '../../hooks/UseForm';\nimport { useInstance } from '../../hooks/UseInstance';\nimport { useUserState } from '../../states/UserState';\nimport SalesOrderAllocationTable from '../../tables/sales/SalesOrderAllocationTable';\n\nexport default function SalesOrderShipmentDetail() {\n  const { id } = useParams();\n  const user = useUserState();\n  const navigate = useNavigate();\n\n  const userId = useMemo(() => user.userId(), [user]);\n\n  const {\n    instance: shipment,\n    instanceQuery: shipmentQuery,\n    refreshInstance: refreshShipment\n  } = useInstance({\n    endpoint: ApiEndpoints.sales_order_shipment_list,\n    pk: id,\n    params: {\n      order_detail: true\n    }\n  });\n\n  const {\n    instance: customer,\n    instanceQuery: customerQuery,\n    refreshInstance: refreshCustomer\n  } = useInstance({\n    endpoint: ApiEndpoints.company_list,\n    pk: shipment.order_detail?.customer,\n    hasPrimaryKey: true\n  });\n\n  const isPending = useMemo(() => !shipment.shipment_date, [shipment]);\n\n  const isChecked = useMemo(() => !!shipment.checked_by, [shipment]);\n\n  const detailsPanel = useMemo(() => {\n    if (shipmentQuery.isFetching || customerQuery.isFetching) {\n      return <Skeleton />;\n    }\n\n    const data: any = {\n      ...shipment,\n      customer: customer?.pk,\n      customer_name: customer?.name,\n      customer_reference: shipment.order_detail?.customer_reference\n    };\n\n    // Top Left: Order / customer information\n    const tl: DetailsField[] = [\n      {\n        type: 'link',\n        model: ModelType.salesorder,\n        name: 'order',\n        label: t`Sales Order`,\n        icon: 'sales_orders',\n        model_field: 'reference'\n      },\n      {\n        type: 'link',\n        name: 'customer',\n        icon: 'customers',\n        label: t`Customer`,\n        model: ModelType.company,\n        model_field: 'name',\n        hidden: !data.customer\n      },\n      {\n        type: 'link',\n        external: true,\n        name: 'link',\n        label: t`Link`,\n        copy: true,\n        hidden: !shipment.link\n      }\n    ];\n\n    // Top right: Shipment information\n    const tr: DetailsField[] = [\n      {\n        type: 'text',\n        name: 'customer_reference',\n        icon: 'serial',\n        label: t`Customer Reference`,\n        hidden: !data.customer_reference,\n        copy: true\n      },\n      {\n        type: 'text',\n        name: 'reference',\n        icon: 'serial',\n        label: t`Shipment Reference`,\n        copy: true\n      },\n      {\n        type: 'text',\n        name: 'tracking_number',\n        label: t`Tracking Number`,\n        icon: 'trackable',\n        value_formatter: () => shipment.tracking_number || '---',\n        copy: !!shipment.tracking_number\n      },\n      {\n        type: 'text',\n        name: 'invoice_number',\n        label: t`Invoice Number`,\n        icon: 'serial',\n        value_formatter: () => shipment.invoice_number || '---',\n        copy: !!shipment.invoice_number\n      }\n    ];\n\n    const address: any =\n      shipment.shipment_address_detail || shipment.order_detail?.address_detail;\n\n    const bl: DetailsField[] = [\n      {\n        type: 'text',\n        name: 'address',\n        label: t`Shipping Address`,\n        icon: 'address',\n        value_formatter: () =>\n          address ? (\n            <RenderAddress\n              instance={\n                shipment.shipment_address_detail ||\n                shipment.order_detail?.address_detail\n              }\n            />\n          ) : (\n            <Text size='sm' c='red'>{t`Not specified`}</Text>\n          )\n      }\n    ];\n\n    const br: DetailsField[] = [\n      {\n        type: 'text',\n        name: 'allocated_items',\n        icon: 'packages',\n        label: t`Allocated Items`\n      },\n      {\n        type: 'text',\n        name: 'checked_by',\n        label: t`Checked By`,\n        icon: 'check',\n        value_formatter: () =>\n          shipment.checked_by_detail ? (\n            <RenderUser instance={shipment.checked_by_detail} />\n          ) : (\n            <Text size='sm' c='red'>{t`Not checked`}</Text>\n          )\n      },\n      {\n        type: 'text',\n        name: 'shipment_date',\n        label: t`Shipment Date`,\n        icon: 'calendar',\n        value_formatter: () => formatDate(shipment.shipment_date),\n        hidden: !shipment.shipment_date\n      },\n      {\n        type: 'text',\n        name: 'delivery_date',\n        label: t`Delivery Date`,\n        icon: 'calendar',\n        value_formatter: () => formatDate(shipment.delivery_date),\n        hidden: !shipment.delivery_date\n      }\n    ];\n\n    return (\n      <>\n        <ItemDetailsGrid>\n          <Grid grow>\n            <DetailsImage\n              appRole={UserRoles.sales_order}\n              apiPath={ApiEndpoints.company_list}\n              src={customer?.image}\n              pk={customer?.pk}\n              imageActions={{\n                selectExisting: false,\n                downloadImage: false,\n                uploadFile: false,\n                deleteFile: false\n              }}\n            />\n            <Grid.Col span={{ base: 12, sm: 8 }}>\n              <DetailsTable fields={tl} item={data} />\n            </Grid.Col>\n          </Grid>\n          <DetailsTable fields={tr} item={data} />\n          <DetailsTable fields={bl} item={data} />\n          <DetailsTable fields={br} item={data} />\n        </ItemDetailsGrid>\n      </>\n    );\n  }, [shipment, shipmentQuery, customer, customerQuery]);\n\n  const shipmentPanels: PanelType[] = useMemo(() => {\n    return [\n      {\n        name: 'detail',\n        label: t`Shipment Details`,\n        icon: <IconInfoCircle />,\n        content: detailsPanel\n      },\n      {\n        name: 'items',\n        label: t`Allocated Stock`,\n        icon: <IconBookmark />,\n        content: (\n          <SalesOrderAllocationTable\n            orderId={shipment.order}\n            shipmentId={shipment.pk}\n            showPartInfo\n            allowEdit={isPending}\n            modelField='item'\n            modelTarget={ModelType.stockitem}\n          />\n        )\n      },\n      AttachmentPanel({\n        model_type: ModelType.salesordershipment,\n        model_id: shipment.pk\n      }),\n      NotesPanel({\n        model_type: ModelType.salesordershipment,\n        model_id: shipment.pk\n      })\n    ];\n  }, [isPending, shipment, detailsPanel]);\n\n  const editShipmentFields = useSalesOrderShipmentFields({\n    pending: isPending,\n    customerId: shipment.order_detail?.customer\n  });\n\n  const editShipment = useEditApiFormModal({\n    url: ApiEndpoints.sales_order_shipment_list,\n    pk: shipment.pk,\n    fields: editShipmentFields,\n    title: t`Edit Shipment`,\n    onFormSuccess: refreshShipment\n  });\n\n  const deleteShipment = useDeleteApiFormModal({\n    url: ApiEndpoints.sales_order_shipment_list,\n    pk: shipment.pk,\n    title: t`Cancel Shipment`,\n    onFormSuccess: () => {\n      // Shipment has been deleted - navigate back to the sales order\n      navigate(getDetailUrl(ModelType.salesorder, shipment.order));\n    }\n  });\n\n  const completeShipmentFields = useSalesOrderShipmentCompleteFields({});\n\n  const completeShipment = useCreateApiFormModal({\n    url: ApiEndpoints.sales_order_shipment_complete,\n    pk: shipment.pk,\n    fields: completeShipmentFields,\n    title: t`Complete Shipment`,\n    focus: 'tracking_number',\n    initialData: {\n      ...shipment,\n      shipment_date: dayjs().format('YYYY-MM-DD')\n    },\n    onFormSuccess: refreshShipment\n  });\n\n  const checkShipment = useEditApiFormModal({\n    url: ApiEndpoints.sales_order_shipment_list,\n    pk: shipment.pk,\n    title: t`Check Shipment`,\n    preFormContent: (\n      <Alert color='green' icon={<IconCircleCheck />} title={t`Check Shipment`}>\n        <Text>{t`Marking the shipment as checked indicates that you have verified that all items included in this shipment are correct`}</Text>\n      </Alert>\n    ),\n    fetchInitialData: false,\n    fields: {\n      checked_by: {\n        hidden: true,\n        value: userId\n      }\n    },\n    successMessage: t`Shipment marked as checked`,\n    onFormSuccess: refreshShipment\n  });\n\n  const uncheckShipment = useEditApiFormModal({\n    url: ApiEndpoints.sales_order_shipment_list,\n    pk: shipment.pk,\n    title: t`Uncheck Shipment`,\n    preFormContent: (\n      <Alert color='red' icon={<IconCircleX />} title={t`Uncheck Shipment`}>\n        <Text>{t`Marking the shipment as unchecked indicates that the shipment requires further verification`}</Text>\n      </Alert>\n    ),\n    fetchInitialData: false,\n    fields: {\n      checked_by: {\n        hidden: true,\n        value: null\n      }\n    },\n    successMessage: t`Shipment marked as unchecked`,\n    onFormSuccess: refreshShipment\n  });\n\n  const shipmentBadges = useMemo(() => {\n    if (shipmentQuery.isFetching) {\n      return [];\n    }\n\n    return [\n      <DetailsBadge\n        key='pending'\n        label={t`Pending`}\n        color='gray'\n        visible={isPending}\n      />,\n      <DetailsBadge\n        key='checked'\n        label={t`Checked`}\n        color='green'\n        visible={isPending && isChecked}\n      />,\n      <DetailsBadge\n        key='not-checked'\n        label={t`Not Checked`}\n        color='red'\n        visible={isPending && !isChecked}\n      />,\n      <DetailsBadge\n        key='shipped'\n        label={t`Shipped`}\n        color='green'\n        visible={!isPending}\n      />,\n      <DetailsBadge\n        key='delivered'\n        label={t`Delivered`}\n        color='blue'\n        visible={!!shipment.delivery_date}\n      />\n    ];\n  }, [isPending, isChecked, shipment.deliveryDate, shipmentQuery.isFetching]);\n\n  const shipmentActions = useMemo(() => {\n    const canEdit: boolean = user.hasChangePermission(\n      ModelType.salesordershipment\n    );\n\n    return [\n      <PrimaryActionButton\n        key='send-shipment'\n        title={t`Send Shipment`}\n        icon='sales_orders'\n        hidden={!isPending}\n        color='green'\n        onClick={() => {\n          completeShipment.open();\n        }}\n      />,\n      <BarcodeActionDropdown\n        key='barcode'\n        model={ModelType.salesordershipment}\n        pk={shipment.pk}\n        hash={shipment?.barcode_hash}\n      />,\n      <PrintingActions\n        key='print'\n        modelType={ModelType.salesordershipment}\n        items={[shipment.pk]}\n        enableLabels\n        enableReports\n      />,\n      <OptionsActionDropdown\n        key='actions'\n        tooltip={t`Shipment Actions`}\n        actions={[\n          EditItemAction({\n            hidden: !canEdit,\n            onClick: editShipment.open,\n            tooltip: t`Edit Shipment`\n          }),\n          {\n            hidden: !isPending || isChecked,\n            name: t`Check`,\n            tooltip: t`Mark shipment as checked`,\n            icon: <IconCircleCheck color='green' />,\n            onClick: checkShipment.open\n          },\n          {\n            hidden: !isPending || !isChecked,\n            name: t`Uncheck`,\n            tooltip: t`Mark shipment as unchecked`,\n            icon: <IconCircleX color='red' />,\n            onClick: uncheckShipment.open\n          },\n          CancelItemAction({\n            hidden: !isPending,\n            onClick: deleteShipment.open,\n            tooltip: t`Cancel Shipment`\n          })\n        ]}\n      />\n    ];\n  }, [isChecked, isPending, user, shipment]);\n\n  return (\n    <>\n      {completeShipment.modal}\n      {editShipment.modal}\n      {deleteShipment.modal}\n      {checkShipment.modal}\n      {uncheckShipment.modal}\n      <InstanceDetail\n        query={shipmentQuery}\n        requiredRole={UserRoles.sales_order}\n      >\n        <Stack gap='xs'>\n          <PageDetail\n            title={`${t`Sales Order Shipment`}: ${shipment.reference}`}\n            subtitle={`${t`Sales Order`}: ${shipment.order_detail?.reference}`}\n            breadcrumbs={[\n              { name: t`Sales`, url: '/sales/' },\n              {\n                name: shipment.order_detail?.reference,\n                url: getDetailUrl(ModelType.salesorder, shipment.order)\n              }\n            ]}\n            badges={shipmentBadges}\n            imageUrl={customer?.image}\n            editAction={editShipment.open}\n            editEnabled={user.hasChangePermission(ModelType.salesordershipment)}\n            actions={shipmentActions}\n          />\n          <PanelGroup\n            pageKey='salesordershipment'\n            panels={shipmentPanels}\n            model={ModelType.salesordershipment}\n            reloadInstance={refreshShipment}\n            instance={shipment}\n            id={shipment.pk}\n          />\n        </Stack>\n      </InstanceDetail>\n    </>\n  );\n}\n"],"names":["SalesOrderShipmentDetail","id","useParams","user","useUserState","navigate","useNavigate","userId","useMemo","instance","shipment","instanceQuery","shipmentQuery","refreshInstance","refreshShipment","useInstance","endpoint","ApiEndpoints","sales_order_shipment_list","pk","params","order_detail","customer","customerQuery","company_list","hasPrimaryKey","isPending","shipment_date","isChecked","checked_by","detailsPanel","isFetching","Skeleton","data","customer_name","name","customer_reference","tl","type","model","ModelType","salesorder","label","_i18n","_","icon","model_field","company","hidden","external","copy","link","tr","value_formatter","tracking_number","invoice_number","address","shipment_address_detail","address_detail","bl","RenderAddress","jsx","Text","br","checked_by_detail","RenderUser","formatDate","delivery_date","Fragment","ItemDetailsGrid","jsxs","Grid","DetailsImage","UserRoles","sales_order","image","selectExisting","downloadImage","uploadFile","deleteFile","base","sm","DetailsTable","shipmentPanels","IconInfoCircle","content","IconBookmark","SalesOrderAllocationTable","order","stockitem","AttachmentPanel","model_type","salesordershipment","model_id","NotesPanel","editShipmentFields","useSalesOrderShipmentFields","pending","customerId","editShipment","useEditApiFormModal","url","fields","title","onFormSuccess","deleteShipment","useDeleteApiFormModal","getDetailUrl","completeShipmentFields","useSalesOrderShipmentCompleteFields","completeShipment","useCreateApiFormModal","sales_order_shipment_complete","focus","initialData","dayjs","format","checkShipment","preFormContent","Alert","IconCircleCheck","fetchInitialData","value","successMessage","uncheckShipment","IconCircleX","shipmentBadges","DetailsBadge","deliveryDate","shipmentActions","canEdit","hasChangePermission","PrimaryActionButton","open","BarcodeActionDropdown","barcode_hash","PrintingActions","OptionsActionDropdown","EditItemAction","onClick","tooltip","CancelItemAction","modal","InstanceDetail","Stack","PageDetail","reference","PanelGroup"],"mappings":"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"}