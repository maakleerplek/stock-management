import{K as Oe,ag as me,r as d,bc as l,ab as t,an as F,ao as u,j as e,aq as z,a8 as Ae,aO as C,b2 as Pe,N as $,a7 as _e,d as U,S as K,ba as Te,aj as Be,$ as oe,al as le,az as De,b5 as A,c8 as re,aD as Re}from"./index-DjOBj_Ai.js";import{A as Le}from"./AdminButton-B8c0S9L9.js";import{P as ne}from"./PrimaryActionButton-BAA_Awc0.js";import{u as we,d as Ee,R as Me,I as qe,B as Ne,P as ve,O as ze,E as Ue,b as Ge,H as Ve,C as We}from"./InvenTreeTable-C-s5lvnS.js";import{I as He,D as W,a as Ke}from"./InstanceDetail-DPGTPy9_.js";import{D as Ze}from"./DetailsBadge-BUJWq3FE.js";import{D as Qe,A as Je,N as Ye}from"./NotesPanel-Gq5AAnCV.js";import{P as Xe}from"./PageDetail-1HLwiKVO.js";import{P as $e}from"./PanelGroup-_Eigw1UV.js";import{c as S,j as be,S as et,ai as tt,Y as st,Z as at,_ as it,$ as ot,a0 as lt,a1 as rt,m as nt,Q as dt,g as ct,f as ut}from"./Filter-CpWhllKn.js";import{d as pt,e as mt,f as _t,g as bt,u as de}from"./BuildForms-BNnXhzVm.js";import{u as H}from"./UseInstance-BYH4ds5B.js";import{u as he}from"./UseStatusCodes-BH1R2YPA.js";import{B as ht}from"./BuildAllocatedStockTable-DiOHvKTH.js";import{a as fe,P as ft}from"./BuildLineTable-CaaXgy5P.js";import{B as xt}from"./BuildOrderTable-kSdveWqR.js";import{a as kt,A as ce,z as j,a9 as jt,n as yt,S as gt,a1 as It,y as xe,aq as Ct,aE as St,aM as Ft,p as Ot,ar as ke}from"./ThemeContext-BjJu0IKI.js";import{A as X}from"./ActionButton-D4nRdKaB.js";import{P as ue}from"./index-_kfXKtfq.js";import{u as At}from"./DesktopAppView-D6tHFi_e.js";import{a as Pt,v as Tt}from"./PluginUIFeature-DWPwHUQS.js";import{u as Bt}from"./UseStockAdjustActions-B7uQUwuU.js";import{P as Dt,S as Rt,j as Lt,l as wt}from"./ColumnRenderers-BCeqgJNS.js";import{P as Et}from"./PurchaseOrderTable-OqQsSE0n.js";import{S as pe}from"./StockItemTable-D_Czm6nE.js";import{I as Mt}from"./IconListCheck-ByTzoI8l.js";import{I as qt}from"./IconChecklist-DvRIMPyQ.js";import"./IconChevronDown-I6OOyduR.js";import"./QRCode-BL-P7mX-.js";import"./browser-JUP5PmmS.js";import"./IconDotsVertical-CGvw5eIR.js";import"./IconTags-Bukq1non.js";import"./YesNoButton-CYsvXLSb.js";import"./formatters-Dkpc25sQ.js";import"./ModelType-BxY4rynO.js";import"./GenericErrorPage-BWQWzpn2.js";import"./NotFound-BksZ8Fp_.js";import"./PermissionDenied-CPiNkqvu.js";import"./use-hover-CbuFBCOT.js";import"./index-Chjiymov.js";import"./AttachmentLink-EwW6behJ.js";import"./PageTitle-CaObz4lR.js";import"./RemoteComponent-CrOPmrx3.js";import"./IconCircleDashedCheck-FiF_1OHY.js";import"./OrderPartsWizard-CtcPC0ec.js";import"./CompanyForms-BrBn0vUb.js";import"./IconAt-B6wo_srX.js";import"./IconUsers-DgSduCbv.js";import"./IconAddressBook-0_3zwfXJ.js";import"./RowExpansionIcon-CUnOv-Ch.js";import"./IconChevronRight-BBTCuiZt.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],vt=Oe("outline","list-numbers","ListNumbers",Nt);function zt({build:a,output:r,opened:b,close:c}){return e.jsxs(Te,{position:"bottom",size:"lg",title:e.jsxs($,{p:"xs",wrap:"nowrap",justify:"space-apart",children:[e.jsx(gt,{size:"lg",children:t._({id:"XqhL5S"})}),e.jsx(le,{h:"lg"}),e.jsx(oe,{withBorder:!0,p:"sm",children:e.jsxs($,{gap:"xs",children:[e.jsx(wt,{part:a.part_detail}),r?.serial&&e.jsxs(U,{size:"sm",children:[t._({id:"AXeJt4"}),": ",r.serial]}),r?.batch&&e.jsxs(U,{size:"sm",children:[t._({id:"Vea6Aj"}),": ",r.batch]})]})}),e.jsx(le,{h:"lg"})]}),opened:b,onClose:c,withCloseButton:!0,closeOnEscape:!0,closeOnClickOutside:!0,styles:{header:{width:"100%"},title:{width:"100%"}},children:[e.jsx(Be,{}),e.jsx(oe,{p:"md",children:e.jsx(fe,{build:a,output:r,params:{tracked:!0}})})]})}function Ut({build:a,refreshBuild:r}){const b=At(),c=me(),y=kt(),i=we("build-outputs"),s=d.useMemo(()=>a.pk??-1,[a.pk]),p=d.useMemo(()=>a.part??-1,[a.part]),g=he({modelType:l.build}),{data:f,refetch:G}=ce({queryKey:["buildoutputtests",p,a],queryFn:async()=>!p||p<0?[]:a?.part_detail?.testable?b.get(F(u.part_test_template_list),{params:{part:p,include_inherited:!0,enabled:!0,required:!0}}).then(o=>o.data):[]}),L=d.useMemo(()=>(f?.length??0)>0,[p,f]),{data:k,refetch:P}=ce({queryKey:["trackeditems",s],queryFn:async()=>!s||s<0?[]:b.get(F(u.build_line_list),{params:{build:s,tracked:!0}}).then(o=>o.data)}),h=d.useMemo(()=>(k?.length??0)>0,[k]);d.useEffect(()=>{i.refreshTable()},[f,k,h,L]);const Z=d.useCallback(o=>(o?.forEach((x,I)=>{const se=[];let ae=0;f?.forEach(R=>{const v=x.tests?.filter(O=>O.template==R.pk).sort((O,Fe)=>O.pk<Fe.pk?1:-1).shift();R?.required&&v?.result&&(ae+=1),se.push({name:R.test_name,result:v?.result??!1})}),o[I].passCount=ae,o[I].results=se;let ie=0;k?.forEach(R=>{let v=0;R.allocations?.filter(O=>O.install_into==x.pk)?.forEach(O=>{v+=O.quantity}),v>=R.bom_item_detail.quantity&&(ie+=1)}),o[I].fullyAllocated=ie}),o),[p,s,f,k]),Q=pt({build:a,modalId:"add-build-output"}),w=S({url:F(u.build_output_create,s),title:t._({id:"jgrPxc"}),modalId:"add-build-output",fields:Q,successMessage:t._({id:"U3Kfc5"}),timeout:1e4,initialData:{batch_code:a.batch,location:a.destination??a.part_detail?.default_location},onFormSuccess:()=>{P(),G(),i.refreshTable(!0)}}),[m,_]=d.useState([]),T=mt({build:a,outputs:m,onFormSuccess:()=>{i.refreshTable(!0),r()}}),E=_t({build:a,outputs:m,onFormSuccess:()=>{i.refreshTable(!0),r()}}),B=bt({build:a,outputs:m,onFormSuccess:()=>{i.refreshTable(!0),r()}}),J=Pt({create:!1,partId:p,stockItem:m[0],modalId:"edit-build-output"}),V=be({url:u.stock_item_list,pk:m[0]?.pk,title:t._({id:"yP367G"}),modalId:"edit-build-output",fields:J,table:i}),n=S({url:u.build_order_deallocate,pk:a.pk,title:t._({id:"ZZL0Jx"}),preFormContent:e.jsx(z,{color:"yellow",icon:e.jsx(Ae,{}),title:t._({id:"ZZL0Jx"}),children:t._({id:"1s7aZ2"})}),fields:{output:{hidden:!0}},initialData:{output:m[0]?.pk},onFormSuccess:()=>{P()}}),M=Tt({partId:m[0]?.part,trackable:m[0]?.part_detail?.trackable,modalId:"build-output-serialize"}),D=S({url:u.stock_serialize,pk:m[0]?.pk,title:t._({id:"euHSRJ"}),modalId:"build-output-serialize",fields:M,initialData:{quantity:m[0]?.quantity??1,destination:m[0]?.location??a.destination},onFormSuccess:()=>{i.refreshTable(!0),r()}}),q=d.useMemo(()=>[{name:"status",label:t._({id:"uAQUqI"}),description:t._({id:"+Jr1e4"}),choiceFunction:et(l.stockitem)},tt(),st(),at(),it(),ot(),lt(),rt()],[]),N=d.useMemo(()=>({items:i.selectedRecords,model:l.stockitem,refresh:i.refreshTable,filters:{}}),[i.selectedRecords,i.refreshTable]),Y=Bt({formProps:N,merge:!1,assign:!1,delete:!1,add:!1,count:!1,remove:!1}),ye=d.useMemo(()=>[Y.dropdown,e.jsx(X,{tooltip:t._({id:"jNuqfk"}),icon:e.jsx(j,{icon:"success"}),color:"green",disabled:!i.hasSelectedRecords,onClick:()=>{_(i.selectedRecords),T.open()}},"complete-selected-outputs"),e.jsx(X,{tooltip:t._({id:"ps+JBt"}),icon:e.jsx(j,{icon:"scrap"}),color:"red",disabled:!i.hasSelectedRecords,onClick:()=>{_(i.selectedRecords),E.open()}},"scrap-selected-outputs"),e.jsx(X,{tooltip:t._({id:"MXiIO4"}),icon:e.jsx(j,{icon:"cancel"}),color:"red",disabled:!i.hasSelectedRecords,onClick:()=>{_(i.selectedRecords),B.open()}},"cancel-selected-outputs"),e.jsx(nt,{tooltip:t._({id:"jgrPxc"}),hidden:a.external||!c.hasAddRole(C.build),onClick:w.open},"add-build-output")],[a,c,i.selectedRecords,i.hasSelectedRecords,Y.dropdown]),ge=d.useCallback(o=>{const x=a?.status==g.PRODUCTION;return[Ee({title:t._({id:"MeORpZ"}),modelId:o.pk,modelType:l.stockitem,navigate:y}),{title:t._({id:"9X8lAk"}),tooltip:t._({id:"kHgU4C"}),color:"blue",hidden:!x||!h||!c.hasChangeRole(C.build),icon:e.jsx(j,{icon:"plus"}),onClick:()=>{_([o]),ee()}},{title:t._({id:"kp5oT9"}),tooltip:t._({id:"NLp8ve"}),color:"red",hidden:!x||!h||!c.hasChangeRole(C.build),icon:e.jsx(j,{icon:"minus"}),onClick:()=>{_([o]),n.open()}},{title:t._({id:"Wlr+mY"}),tooltip:t._({id:"+as741"}),color:"blue",hidden:!o.part_detail?.trackable||!!o.serial,icon:e.jsx(j,{icon:"serial"}),onClick:()=>{_([o]),D.open()}},{title:t._({id:"bD8I7O"}),tooltip:t._({id:"BdMeIY"}),color:"green",icon:e.jsx(j,{icon:"success"}),onClick:()=>{_([o]),T.open()}},Me({tooltip:t._({id:"yP367G"}),onClick:()=>{_([o]),V.open()}}),{title:t._({id:"5mspUE"}),tooltip:t._({id:"oise/z"}),icon:e.jsx(j,{icon:"scrap"}),color:"red",onClick:()=>{_([o]),E.open()}},{title:t._({id:"dEgA5A"}),tooltip:t._({id:"ewDpt2"}),icon:e.jsx(j,{icon:"cancel"}),color:"red",onClick:()=>{_([o]),B.open()}}]},[g,c,p,h]),Ie=d.useMemo(()=>[Dt({}),{accessor:"quantity",ordering:"stock",sortable:!0,switchable:!1,title:t._({id:"gILim+"}),render:o=>{let x=o.quantity;return o.serial&&(x=`# ${o.serial}`),x}},{accessor:"batch",sortable:!0},Rt({accessor:"status",sortable:!0,model:l.stockitem}),Lt({accessor:"location_detail"}),{accessor:"allocations",sortable:!1,switchable:!1,hidden:!h,title:t._({id:"/b62hy"}),render:o=>e.jsx(ue,{progressLabel:!0,value:o.fullyAllocated??0,maximum:k?.length??0})},{accessor:"tests",sortable:!1,switchable:!1,title:t._({id:"E4lFEY"}),hidden:!L,render:o=>{const x=o.results?.map(I=>I&&e.jsxs($,{justify:"left",wrap:"nowrap",children:[I.result?e.jsx(_e,{color:"green"}):e.jsx(jt,{color:"red"}),e.jsx(U,{children:I.name})]},I.name))??[];return e.jsx(dt,{value:e.jsx(ue,{progressLabel:!0,value:o.passCount??0,maximum:f?.length??0}),extra:x,title:t._({id:"isbwWo"})})}}],[s,p,L,h,f,k]),[Ce,{open:ee,close:te}]=Pe(!1),Se=d.useCallback(()=>{te(),P()},[te,P]);return e.jsxs(e.Fragment,{children:[w.modal,T.modal,E.modal,V.modal,n.modal,B.modal,D.modal,Y.modals.map(o=>o.modal),e.jsx(zt,{build:a,output:m[0],opened:Ce,close:Se}),e.jsxs(K,{gap:"xs",children:[a.external&&e.jsx(z,{color:"blue",icon:e.jsx(yt,{}),title:t._({id:"ckc7Jf"}),children:t._({id:"5pH9Hn"})}),e.jsx(qe,{tableState:i,url:F(u.stock_item_list),columns:Ie,props:{params:{part_detail:!0,location_detail:!0,tests:!0,is_building:!0,build:s},enableLabels:!0,enableReports:!0,modelType:l.stockitem,dataFormatter:Z,tableFilters:q,tableActions:ye,rowActions:ge,enableSelection:!0,onRowClick:o=>{h&&o.serial&&(_([o]),ee())}}})]})]})}function je(){return e.jsx(z,{color:"blue",icon:e.jsx(xe,{}),title:t._({id:"RBkcix"}),children:e.jsxs(K,{gap:"xs",children:[e.jsx(U,{children:t._({id:"bcmsL1"})}),e.jsx(U,{children:t._({id:"qMpNaN"})})]})})}function Gt({build:a,isLoading:r,hasItems:b}){const c=H({endpoint:u.stock_location_list,pk:a?.take_from,hasPrimaryKey:!0,defaultValue:{}});return r||!a.pk?e.jsx(A,{w:"100%",h:400,animate:!0}):b?e.jsxs(K,{gap:"xs",children:[c.instance.pk&&e.jsx(z,{color:"blue",icon:e.jsx(ke,{}),title:t._({id:"/00Ond"}),children:e.jsx(ut,{instance:c.instance})}),e.jsx(fe,{build:a})]}):e.jsx(je,{})}function Vt({build:a,isLoading:r,hasItems:b}){return r||!a.pk?e.jsx(A,{w:"100%",h:400,animate:!0}):b?e.jsx(ht,{buildId:a.pk,showPartInfo:!0,allowEdit:!0}):e.jsx(je,{})}function Us(){const{id:a}=It(),r=me(),b=De(),{instance:c,instanceQuery:y}=H({endpoint:u.build_line_list,params:{build:a,allocations:!1,part_detail:!1,build_detail:!1,bom_item_detail:!1,limit:1},disabled:!a,hasPrimaryKey:!1,defaultValue:{}}),i=he({modelType:l.build}),{instance:s,refreshInstance:p,instanceQuery:g}=H({endpoint:u.build_order_list,pk:a,params:{part_detail:!0},refetchOnMount:!0}),{instance:f,instanceQuery:G}=H({endpoint:u.part_requirements,pk:s?.part,hasPrimaryKey:!0,defaultValue:{}}),L=d.useMemo(()=>{if(g.isFetching)return e.jsx(A,{});const n={...s,can_build:f?.can_build??0},M=[{type:"link",name:"part",label:t._({id:"vgP+9p"}),model:l.part},{type:"text",name:"part_detail.IPN",icon:"part",label:t._({id:"3wXEsN"}),hidden:!s.part_detail?.IPN,copy:!0},{type:"string",name:"part_detail.revision",icon:"revision",label:t._({id:"6LTyxl"}),hidden:!s.part_detail?.revision,copy:!0},{type:"status",name:"status",label:t._({id:"uAQUqI"}),model:l.build},{type:"status",name:"status_custom_key",label:t._({id:"4DvUAJ"}),model:l.build,icon:"status",hidden:!s.status_custom_key||s.status_custom_key==s.status},{type:"boolean",name:"external",label:t._({id:"bVhrVt"}),icon:"manufacturers",hidden:!s.external},{type:"text",name:"reference",label:t._({id:"N2C89m"}),copy:!0},{type:"text",name:"title",label:t._({id:"Nu4oKW"}),icon:"description",copy:!0},{type:"link",name:"parent",icon:"builds",label:t._({id:"jqsG41"}),model_field:"reference",model:l.build,hidden:!s.parent}],D=[{type:"number",name:"quantity",label:t._({id:"Ee+3kG"})},{type:"number",name:"can_build",unit:s.part_detail?.units,label:t._({id:"S/9nwz"}),hidden:G.isFetching},{type:"progressbar",name:"completed",icon:"progress",total:s.quantity,progress:s.completed,label:t._({id:"Mzv4va"})},{type:"link",name:"sales_order",label:t._({id:"LozYBo"}),icon:"sales_orders",model:l.salesorder,model_field:"reference",hidden:!s.sales_order}],q=[{type:"text",name:"issued_by",label:t._({id:"kmUN8p"}),icon:"user",badge:"user",hidden:!s.issued_by},{type:"text",name:"responsible",label:t._({id:"XQACoK"}),badge:"owner",hidden:!s.responsible},{type:"text",name:"project_code_label",label:t._({id:"Sdfr6G"}),icon:"reference",copy:!0,hidden:!s.project_code},{type:"link",name:"take_from",icon:"location",model:l.stocklocation,label:t._({id:"/00Ond"}),backup_value:t._({id:"aZD9Yv"})},{type:"link",name:"destination",icon:"location",model:l.stocklocation,label:t._({id:"o35LCI"}),hidden:!s.destination},{type:"text",name:"batch",label:t._({id:"Vea6Aj"}),hidden:!s.batch,copy:!0}],N=[{type:"date",name:"creation_date",label:t._({id:"d+F6q9"}),icon:"calendar",copy:!0,hidden:!s.creation_date},{type:"date",name:"start_date",label:t._({id:"D3iCkb"}),icon:"calendar",copy:!0,hidden:!s.start_date},{type:"date",name:"target_date",label:t._({id:"ZmykKo"}),icon:"calendar",copy:!0,hidden:!s.target_date},{type:"date",name:"completion_date",label:t._({id:"qqWcBV"}),icon:"calendar",copy:!0,hidden:!s.completion_date}];return e.jsxs(He,{children:[e.jsxs(re,{grow:!0,children:[e.jsx(Qe,{appRole:C.part,apiPath:u.part_list,src:s.part_detail?.image??s.part_detail?.thumbnail,pk:s.part}),e.jsx(re.Col,{span:{base:12,sm:8},children:e.jsx(W,{fields:M,item:n})})]}),e.jsx(W,{fields:D,item:n}),e.jsx(W,{fields:q,item:n}),e.jsx(W,{fields:N,item:n})]})},[s,g,f,G.isFetching]),k=d.useMemo(()=>[{name:"details",label:t._({id:"98Q4bz"}),icon:e.jsx(xe,{}),content:L},{name:"line-items",label:t._({id:"T2s1M7"}),icon:e.jsx(vt,{}),content:e.jsx(Gt,{build:s,isLoading:y.isFetching||y.isLoading,hasItems:c?.count>0})},{name:"allocated-stock",label:t._({id:"MD2yP5"}),icon:e.jsx(Ct,{}),hidden:s.status==i.COMPLETE||s.status==i.CANCELLED||(c?.count??0)<=0,content:e.jsx(Vt,{build:s,isLoading:y.isFetching||y.isLoading,hasItems:c?.count>0})},{name:"consumed-stock",label:t._({id:"US3GCq"}),icon:e.jsx(Mt,{}),hidden:(c?.count??0)<=0,content:e.jsx(pe,{allowAdd:!1,tableName:"build-consumed",showLocation:!1,allowReturn:!0,params:{consumed_by:a}})},{name:"incomplete-outputs",label:t._({id:"E9en8O"}),icon:e.jsx(St,{}),content:s.pk?e.jsx(Ut,{build:s,refreshBuild:p}):e.jsx(A,{}),hidden:s.status==i.COMPLETE||s.status==i.CANCELLED},{name:"complete-outputs",label:t._({id:"Mzv4va"}),icon:e.jsx(Ft,{}),content:e.jsx(pe,{allowAdd:!1,tableName:"completed-build-outputs",params:{build:a,is_building:!1}})},{name:"external-purchase-orders",label:t._({id:"X0hvRl"}),icon:e.jsx(Ot,{}),content:s.pk?e.jsx(Et,{externalBuildId:s.pk}):e.jsx(A,{}),hidden:!r.hasViewRole(C.purchase_order)||!s.external||!b.isSet("BUILDORDER_EXTERNAL_BUILDS")},{name:"child-orders",label:t._({id:"CVlgqS"}),icon:e.jsx(ke,{}),content:s.pk?e.jsx(xt,{parentBuildId:s.pk}):e.jsx(A,{})},{name:"test-results",label:t._({id:"isbwWo"}),icon:e.jsx(qt,{}),hidden:!s.part_detail?.testable,content:s.pk?e.jsx(ft,{buildId:s.pk,partId:s.part}):e.jsx(A,{})},Je({model_type:l.build,model_id:s.pk}),Ye({model_type:l.build,model_id:s.pk})],[s,a,r,i,b,y.isFetching,y.isLoading,c]),P=de({create:!1,modalId:"edit-build-order"}),h=be({url:u.build_order_list,pk:s.pk,title:t._({id:"B7ynKf"}),modalId:"edit-build-order",fields:P,onFormSuccess:p}),Z=d.useMemo(()=>{const n={...s};return delete n.reference,n},[s]),Q=de({create:!1,modalId:"duplicate-build-order"}),w=S({url:u.build_order_list,title:t._({id:"59jtLx"}),modalId:"duplicate-build-order",fields:Q,initialData:Z,follow:!0,modelType:l.build}),m=S({url:F(u.build_order_cancel,s.pk),title:t._({id:"MTYJu1"}),onFormSuccess:p,successMessage:t._({id:"H5qWhm"}),preFormWarning:t._({id:"MPFqR0"}),fields:{remove_allocated_stock:{},remove_incomplete_outputs:{}}}),_=S({url:F(u.build_order_hold,s.pk),title:t._({id:"hZIvSn"}),onFormSuccess:p,preFormWarning:t._({id:"3Wfk51"}),successMessage:t._({id:"0NH/ob"})}),T=S({url:F(u.build_order_issue,s.pk),title:t._({id:"Z4Rl+B"}),onFormSuccess:p,preFormWarning:t._({id:"lLiNZC"}),successMessage:t._({id:"R/WvFK"})}),E=d.useMemo(()=>{const n=(c?.count??0)>0;return{accept_overallocated:{hidden:!n},accept_unallocated:{hidden:!n},accept_incomplete:{}}},[c.count]),B=S({url:F(u.build_order_complete,s.pk),title:t._({id:"Q/TP3B"}),onFormSuccess:p,preFormContent:e.jsx(z,{color:"green",icon:e.jsx(_e,{}),title:t._({id:"DYITap"})}),successMessage:t._({id:"W7TghJ"}),fields:E}),J=d.useMemo(()=>{const n=r.hasChangeRole(C.build),M=n&&(s.status==i.PENDING||s.status==i.ON_HOLD),D=n&&s.status==i.PRODUCTION,q=n&&(s.status==i.PENDING||s.status==i.PRODUCTION),N=n&&(s.status==i.PENDING||s.status==i.ON_HOLD||s.status==i.PRODUCTION);return[e.jsx(ne,{title:t._({id:"WajCDs"}),icon:"issue",hidden:!M,color:"blue",onClick:T.open}),e.jsx(ne,{title:t._({id:"NPZqBL"}),icon:"complete",hidden:!D,color:"green",onClick:B.open}),e.jsx(Le,{model:l.build,id:s.pk}),e.jsx(Ne,{model:l.build,pk:s.pk,hash:s?.barcode_hash}),e.jsx(ve,{modelType:l.build,items:[s.pk],enableLabels:!0,enableReports:!0}),e.jsx(ze,{tooltip:t._({id:"tDgG1Y"}),actions:[Ue({onClick:()=>h.open(),hidden:!n,tooltip:t._({id:"mVeaUg"})}),Ge({onClick:()=>w.open(),tooltip:t._({id:"oi/3Pq"}),hidden:!r.hasAddRole(C.build)}),Ve({tooltip:t._({id:"20mLBC"}),hidden:!q,onClick:_.open}),We({tooltip:t._({id:"tVJk4q"}),onClick:m.open,hidden:!N})]})]},[a,s,r,i]),V=d.useMemo(()=>g.isFetching?[]:[e.jsx(ct,{status:s.status_custom_key,type:l.build,options:{size:"lg"}}),e.jsx(Ze,{label:t._({id:"bVhrVt"}),color:"blue",visible:s.external},"external")],[s,g]);return e.jsxs(e.Fragment,{children:[h.modal,w.modal,m.modal,_.modal,T.modal,B.modal,e.jsx(Ke,{query:g,requiredRole:C.build,children:e.jsxs(K,{gap:"xs",children:[e.jsx(Xe,{title:`${t._({id:"YxwWvi"})}: ${s.reference}`,subtitle:`${s.quantity} x ${s.part_detail?.full_name}`,badges:V,editAction:h.open,editEnabled:r.hasChangePermission(l.part),imageUrl:s.part_detail?.image??s.part_detail?.thumbnail,breadcrumbs:[{name:t._({id:"3ctapx"}),url:"/manufacturing"}],lastCrumb:[{name:s.reference,url:Re(l.build,s.pk)}],actions:J}),e.jsx($e,{pageKey:"build",panels:k,instance:s,reloadInstance:p,model:l.build,id:s.pk})]})})]})}export{Us as default};
//# sourceMappingURL=BuildDetail-DOLKSTo5.js.map
